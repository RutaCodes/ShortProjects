*HW8* RUTA BASIJOKAITE*;
PROC IMPORT DATAFILE="/folders/myfolders/HW8/PMSA.xlsx" /** Import an XLSX file.  **/
		    OUT=WORK.HW8DATA
		    DBMS=XLSX
		    REPLACE;
		    GETNAMES=YES;
		    SCANTEXT=YES;
RUN;
OPTIONS NOCENTER NODATE PAGENO=1 LS=76 PS=45 NOLABEL;
DATA ALL;
  SET HW8DATA;
RUN;
PROC MEANS N MEAN MEDIAN STD MIN MAX MAXDEC=4;
   VAR CRIME POP AREA YOUNG DIV OLD EDUC POV UNEMP;
   TITLE 'DESCRIPTIVE STATISTICS';
RUN;
PROC CORR PEARSON SPEARMAN;
  VAR CRIME POP AREA YOUNG DIV OLD EDUC POV UNEMP;
  TITLE 'CORRELATION AMONG VARIABLES';
RUN;
PROC SGSCATTER DATA=ALL;
   MATRIX CRIME POP AREA YOUNG DIV OLD EDUC POV UNEMP / DIAGONAL=(HISTOGRAM NORMAL);
   TITLE 'EXPEND CORRELATION WITH FIVE PREDICTOR VARIABLES';
RUN;
PROC REG DATA=ALL OUTEST=RIDGE RIDGE=0 TO 0.2 BY 0.01 OUTVIF;
  MODEL CRIME= POP AREA YOUNG DIV OLD EDUC POV UNEMP / VIF COLLIN;
  TITLE 'FULL MODEL AND RIDGE REGRESSION';
RUN;
PROC PRINT DATA=RIDGE;
  VAR _TYPE_ _RIDGE_ _RMSE_ INTERCEPT POP AREA YOUNG DIV OLD EDUC POV UNEMP;
  WHERE _TYPE_ = 'RIDGE';
RUN;
PROC PRINT DATA=RIDGE;
  VAR _RIDGE_ INTERCEPT POP AREA YOUNG DIV OLD EDUC POV UNEMP;
  WHERE _TYPE_ = 'RIDGEVIF';
RUN;
PROC PRINCOMP DATA=ALL;
  VAR CRIME POP AREA YOUNG DIV OLD EDUC POV UNEMP;
RUN;
PROC REG DATA=ALL OUTEST=PRINEST OUTVIF;
  MODEL CRIME= POP AREA YOUNG DIV OLD EDUC POV UNEMP / PCOMIT=1 TO 6 VIF;
  TITLE 'PRINCIPAL COMPONENT REGRESSION';
RUN;
PROC PRINT DATA=PRINEST;
  VAR _TYPE_ _PCOMIT_ _RMSE_ INTERCEPT POP AREA YOUNG DIV OLD EDUC POV UNEMP;
  WHERE _TYPE_ = 'PARMS';
RUN;
PROC PRINT DATA=PRINEST;
  VAR _TYPE_ _PCOMIT_ _RMSE_ INTERCEPT POP AREA YOUNG DIV OLD EDUC POV UNEMP;
  WHERE _TYPE_ = 'IPC';
RUN;
PROC PRINT DATA=PRINEST;
  VAR _TYPE_ _PCOMIT_ _RMSE_ INTERCEPT POP AREA YOUNG DIV OLD EDUC POV UNEMP;
  WHERE _TYPE_ = 'IPCVIF';
RUN;